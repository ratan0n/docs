{
  "url": "https://docs.anthropic.com/en/docs/about-claude/models/migrating-to-claude-4",
  "title": "Migrating to Claude 4 - Anthropic",
  "text": "Anthropic\nhome page\nEnglish\nSearch...\nSearch...\nNavigation\nModels & pricing\nMigrating to Claude 4\nWelcome\nDeveloper Guide\nAPI Guide\nClaude Code\nModel Context Protocol (MCP)\nResources\nRelease Notes\nDocumentation\nDeveloper Discord\nSupport\nFirst steps\nIntro to Claude\nGet started\nModels & pricing\nModels overview\nChoosing a model\nMigrating to Claude 4\nModel deprecations\nPricing\nLearn about Claude\nBuilding with Claude\nFeatures overview\nContext windows\nGlossary\nCapabilities\nPrompt caching\nExtended thinking\nStreaming Messages\nBatch processing\nCitations\nMultilingual support\nToken counting\nEmbeddings\nVision\nPDF support\nFiles API\nGoogle Sheets add-on\nTools\nOverview\nHow to implement tool use\nToken-efficient tool use\nFine-grained tool streaming\nBash tool\nCode execution tool\nComputer use tool\nText editor tool\nWeb search tool\nModel Context Protocol (MCP)\nMCP connector\nRemote MCP servers\nUse cases\nOverview\nTicket routing\nCustomer support agent\nContent moderation\nLegal summarization\nPrompt engineering\nOverview\nClaude 4 best practices\nPrompt generator\nUse prompt templates\nPrompt improver\nBe clear and direct\nUse examples (multishot prompting)\nLet Claude think (CoT)\nUse XML tags\nGive Claude a role (system prompts)\nPrefill Claude's response\nChain complex prompts\nLong context tips\nExtended thinking tips\nTest & evaluate\nDefine success criteria\nDevelop test cases\nUsing the Evaluation Tool\nReducing latency\nStrengthen guardrails\nReduce hallucinations\nIncrease output consistency\nMitigate jailbreaks\nStreaming refusals\nReduce prompt leak\nKeep Claude in character\nLegal center\nAnthropic Privacy Policy\nSecurity and compliance\nThis page provides guidance on migrating from Claude 3.7 models to Claude 4 models (Opus 4 and Sonnet 4).\nIn most cases, you can switch to Claude 4 models with minimal changes:\nUpdate your model name:\nFrom:\nclaude-3-7-sonnet-20250219\nTo:\nclaude-sonnet-4-20250514\nor\nclaude-opus-4-20250514\nExisting API calls should continue to work without modification, although API behavior has changed slightly in Claude 4 models (see\nAPI release notes\nfor details).\n​\nWhat’s new in Claude 4\n​\nNew refusal stop reason\nClaude 4 models introduce a new\nrefusal\nstop reason for content that the model declines to generate for safety reasons, due to the increased intelligence of Claude 4 models:\n{\n\"id\"\n:\n\"msg_014XEDjypDjFzgKVWdFUXxZP\"\n,\n\"type\"\n:\n\"message\"\n,\n\"role\"\n:\n\"assistant\"\n,\n\"model\"\n:\n\"claude-sonnet-4-20250514\"\n,\n\"content\"\n:\n[\n{\n\"type\"\n:\n\"text\"\n,\n\"text\"\n:\n\"I would be happy to assist you. You can \"\n}\n]\n,\n\"stop_reason\"\n:\n\"refusal\"\n,\n\"stop_sequence\"\n:\nnull\n,\n\"usage\"\n:\n{\n\"input_tokens\"\n:\n564\n,\n\"cache_creation_input_tokens\"\n:\n0\n,\n\"cache_read_input_tokens\"\n:\n0\n,\n\"output_tokens\"\n:\n22\n}\n}\nWhen migrating to Claude 4, you should update your application to\nhandle\nrefusal\nstop reasons\n.\n​\nSummarized thinking\nWith extended thinking enabled, the Messages API for Claude 4 models returns a summary of Claude’s full thinking process. Summarized thinking provides the full intelligence benefits of extended thinking, while preventing misuse.\nWhile the API is consistent across Claude 3.7 and 4 models, streaming responses for extended thinking might return in a “chunky” delivery pattern, with possible delays between streaming events.\nSummarization is processed by a different model than the one you target in your requests. The thinking model does not see the summarized output.\nFor more information, see the\nExtended thinking documentation\n.\n​\nInterleaved thinking\nClaude 4 models support interleaving tool use with extended thinking, allowing for more natural conversations where tool uses and responses can be mixed with regular messages.\nInterleaved thinking is in beta. To enable interleaved thinking, add\nthe beta header\ninterleaved-thinking-2025-05-14\nto your API request.\nFor more information, see the\nExtended thinking documentation\n.\n​\nUpdated text editor tool\nThe text editor tool has been updated for Claude 4 models with the following changes:\nTool type\n:\ntext_editor_20250429\nTool name\n:\nstr_replace_based_edit_tool\nThe\nundo_edit\ncommand is no longer supported in Claude 4 models.\nThe\nstr_replace_editor\ntext editor tool remains the same for Claude Sonnet 3.7.\nIf you’re migrating from Claude Sonnet 3.7 and using the text editor tool:\n# Claude Sonnet 3.7\ntools\n=\n[\n{\n\"type\"\n:\n\"text_editor_20250124\"\n,\n\"name\"\n:\n\"str_replace_editor\"\n}\n]\n# Claude 4\ntools\n=\n[\n{\n\"type\"\n:\n\"text_editor_20250429\"\n,\n\"name\"\n:\n\"str_replace_based_edit_tool\"\n}\n]\nFor more information, see the\nText editor tool documentation\n.\n​\nToken-efficient tool use no longer supported\nToken-efficient tool use\nis only available in Claude Sonnet 3.7.\nIf you’re migrating from Claude Sonnet 3.7 and using token-efficient tool use, we recommend removing the\ntoken-efficient-tools-2025-02-19\nbeta header\nfrom your requests.\nThe\ntoken-efficient-tools-2025-02-19\nbeta header can still be included in Claude 4 requests, but it will have no effect.\n​\nExtended output no longer supported\nThe\noutput-128k-2025-02-19\nbeta header\nfor extended output is only available in Claude Sonnet 3.7.\nIf you’re migrating from Claude Sonnet 3.7, we recommend removing\noutput-128k-2025-02-19\nfrom your requests.\nThe\noutput-128k-2025-02-19\nbeta header can still be included in Claude 4 requests, but it will have no effect.\n​\nPerformance considerations\n​\nClaude Sonnet 4\nImproved reasoning and intelligence capabilities compared to Claude Sonnet 3.7\nEnhanced tool use accuracy\n​\nClaude Opus 4\nMost capable model with superior reasoning and intelligence\nSlower than Sonnet models\nBest for complex tasks requiring deep analysis\n​\nMigration checklist\nUpdate model id in your API calls\nTest existing requests (should work without changes)\nRemove\ntoken-efficient-tools-2025-02-19\nbeta header if applicable\nRemove\noutput-128k-2025-02-19\nbeta header if applicable\nHandle new\nrefusal\nstop reason\nUpdate text editor tool type and name if using it\nRemove any code that uses the\nundo_edit\ncommand\nExplore new tool interleaving capabilities with extended thinking\nReview\nClaude 4 prompt engineering best practices\nfor optimal results\nTest in development before production deployment\n​\nNeed help?\nCheck our\nAPI documentation\nfor detailed specifications.\nReview\nmodel capabilities\nfor performance comparisons.\nReview\nAPI release notes\nfor API updates.\nContact support if you encounter any issues during migration.\nWas this page helpful?\nYes\nNo\nChoosing a model\nModel deprecations\nOn this page\nWhat’s new in Claude 4\nNew refusal stop reason\nSummarized thinking\nInterleaved thinking\nUpdated text editor tool\nToken-efficient tool use no longer supported\nExtended output no longer supported\nPerformance considerations\nClaude Sonnet 4\nClaude Opus 4\nMigration checklist\nNeed help?",
  "links": [
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/models/overview",
      "text": "Models overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/models/choosing-a-model",
      "text": "Choosing a model"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/model-deprecations",
      "text": "Model deprecations"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/pricing",
      "text": "Pricing"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/overview",
      "text": "Building with Claude"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/context-windows",
      "text": "Context windows"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/glossary",
      "text": "Glossary"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-caching",
      "text": "Prompt caching"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/extended-thinking",
      "text": "Extended thinking"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/streaming",
      "text": "Streaming Messages"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/batch-processing",
      "text": "Batch processing"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/citations",
      "text": "Citations"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/multilingual-support",
      "text": "Multilingual support"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/token-counting",
      "text": "Token counting"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/embeddings",
      "text": "Embeddings"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/vision",
      "text": "Vision"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/pdf-support",
      "text": "PDF support"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/files",
      "text": "Files API"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/claude-for-sheets",
      "text": "Google Sheets add-on"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/implement-tool-use",
      "text": "How to implement tool use"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/token-efficient-tool-use",
      "text": "Token-efficient tool use"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/fine-grained-tool-streaming",
      "text": "Fine-grained tool streaming"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/bash-tool",
      "text": "Bash tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/code-execution-tool",
      "text": "Code execution tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/computer-use-tool",
      "text": "Computer use tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/text-editor-tool",
      "text": "Text editor tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/web-search-tool",
      "text": "Web search tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/mcp-connector",
      "text": "MCP connector"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/remote-mcp-servers",
      "text": "Remote MCP servers"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/ticket-routing",
      "text": "Ticket routing"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/customer-support-chat",
      "text": "Customer support agent"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/content-moderation",
      "text": "Content moderation"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/legal-summarization",
      "text": "Legal summarization"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices",
      "text": "Claude 4 best practices"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-generator",
      "text": "Prompt generator"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-templates-and-variables",
      "text": "Use prompt templates"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-improver",
      "text": "Prompt improver"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/be-clear-and-direct",
      "text": "Be clear and direct"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/multishot-prompting",
      "text": "Use examples (multishot prompting)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-of-thought",
      "text": "Let Claude think (CoT)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/use-xml-tags",
      "text": "Use XML tags"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/system-prompts",
      "text": "Give Claude a role (system prompts)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prefill-claudes-response",
      "text": "Prefill Claude's response"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-prompts",
      "text": "Chain complex prompts"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/long-context-tips",
      "text": "Long context tips"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/extended-thinking-tips",
      "text": "Extended thinking tips"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/define-success",
      "text": "Define success criteria"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/develop-tests",
      "text": "Develop test cases"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/eval-tool",
      "text": "Using the Evaluation Tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-latency",
      "text": "Reducing latency"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations",
      "text": "Reduce hallucinations"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/increase-consistency",
      "text": "Increase output consistency"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks",
      "text": "Mitigate jailbreaks"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals",
      "text": "Streaming refusals"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-prompt-leak",
      "text": "Reduce prompt leak"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/keep-claude-in-character",
      "text": "Keep Claude in character"
    }
  ],
  "metadata": {
    "scraped_at": "2025-06-23T15:07:33.982109",
    "word_count": 990,
    "link_count": 59,
    "content_length": 6714
  }
}