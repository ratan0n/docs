{
  "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/web-search-tool",
  "title": "Web search tool - Anthropic",
  "text": "Anthropic\nhome page\nEnglish\nSearch...\nSearch...\nNavigation\nTools\nWeb search tool\nWelcome\nDeveloper Guide\nAPI Guide\nClaude Code\nModel Context Protocol (MCP)\nResources\nRelease Notes\nDocumentation\nDeveloper Discord\nSupport\nFirst steps\nIntro to Claude\nGet started\nModels & pricing\nModels overview\nChoosing a model\nMigrating to Claude 4\nModel deprecations\nPricing\nLearn about Claude\nBuilding with Claude\nFeatures overview\nContext windows\nGlossary\nCapabilities\nPrompt caching\nExtended thinking\nStreaming Messages\nBatch processing\nCitations\nMultilingual support\nToken counting\nEmbeddings\nVision\nPDF support\nFiles API\nGoogle Sheets add-on\nTools\nOverview\nHow to implement tool use\nToken-efficient tool use\nFine-grained tool streaming\nBash tool\nCode execution tool\nComputer use tool\nText editor tool\nWeb search tool\nModel Context Protocol (MCP)\nMCP connector\nRemote MCP servers\nUse cases\nOverview\nTicket routing\nCustomer support agent\nContent moderation\nLegal summarization\nPrompt engineering\nOverview\nClaude 4 best practices\nPrompt generator\nUse prompt templates\nPrompt improver\nBe clear and direct\nUse examples (multishot prompting)\nLet Claude think (CoT)\nUse XML tags\nGive Claude a role (system prompts)\nPrefill Claude's response\nChain complex prompts\nLong context tips\nExtended thinking tips\nTest & evaluate\nDefine success criteria\nDevelop test cases\nUsing the Evaluation Tool\nReducing latency\nStrengthen guardrails\nReduce hallucinations\nIncrease output consistency\nMitigate jailbreaks\nStreaming refusals\nReduce prompt leak\nKeep Claude in character\nLegal center\nAnthropic Privacy Policy\nSecurity and compliance\nThe web search tool gives Claude direct access to real-time web content, allowing it to answer questions with up-to-date information beyond its knowledge cutoff. Claude automatically cites sources from search results as part of its answer.\nPlease reach out through our\nfeedback form\nto share your experience with the web search tool.\n​\nSupported models\nWeb search is available on:\nClaude Opus 4 (\nclaude-opus-4-20250514\n)\nClaude Sonnet 4 (\nclaude-sonnet-4-20250514\n)\nClaude Sonnet 3.7 (\nclaude-3-7-sonnet-20250219\n)\nClaude Sonnet 3.5 (new) (\nclaude-3-5-sonnet-latest\n)\nClaude Haiku 3.5 (\nclaude-3-5-haiku-latest\n)\n​\nHow web search works\nWhen you add the web search tool to your API request:\nClaude decides when to search based on the prompt.\nThe API executes the searches and provides Claude with the results. This process may repeat multiple times throughout a single request.\nAt the end of its turn, Claude provides a final response with cited sources.\n​\nHow to use web search\nYour organization’s administrator must enable web search in\nConsole\n.\nProvide the web search tool in your API request:\nShell\nPython\nTypeScript\ncurl\nhttps://api.anthropic.com/v1/messages\n\\\n--header\n\"x-api-key:\n$ANTHROPIC_API_KEY\n\"\n\\\n--header\n\"anthropic-version: 2023-06-01\"\n\\\n--header\n\"content-type: application/json\"\n\\\n--data\n'\n{\n\"model\"\n:\n\"claude-opus-4-20250514\"\n,\n\"max_tokens\"\n:\n1024\n,\n\"messages\"\n:\n[\n{\n\"role\"\n:\n\"user\"\n,\n\"content\"\n:\n\"How do I update a web app to TypeScript 5.5?\"\n}\n]\n,\n\"tools\"\n:\n[\n{\n\"type\"\n:\n\"web_search_20250305\"\n,\n\"name\"\n:\n\"web_search\"\n,\n\"max_uses\"\n:\n5\n}\n]\n}\n'\n​\nTool definition\nThe web search tool supports the following parameters:\nJSON\n{\n\"type\"\n:\n\"web_search_20250305\"\n,\n\"name\"\n:\n\"web_search\"\n,\n// Optional: Limit the number of searches per request\n\"max_uses\"\n:\n5\n,\n// Optional: Only include results from these domains\n\"allowed_domains\"\n:\n[\n\"example.com\"\n,\n\"trusteddomain.org\"\n]\n,\n// Optional: Never include results from these domains\n\"blocked_domains\"\n:\n[\n\"untrustedsource.com\"\n]\n,\n// Optional: Localize search results\n\"user_location\"\n:\n{\n\"type\"\n:\n\"approximate\"\n,\n\"city\"\n:\n\"San Francisco\"\n,\n\"region\"\n:\n\"California\"\n,\n\"country\"\n:\n\"US\"\n,\n\"timezone\"\n:\n\"America/Los_Angeles\"\n}\n}\n​\nMax uses\nThe\nmax_uses\nparameter limits the number of searches performed. If Claude attempts more searches than allowed, the\nweb_search_tool_result\nwill be an error with the\nmax_uses_exceeded\nerror code.\n​\nDomain filtering\nWhen using domain filters:\nDomains should not include the HTTP/HTTPS scheme (use\nexample.com\ninstead of\nhttps://example.com\n)\nSubdomains are automatically included (\nexample.com\ncovers\ndocs.example.com\n)\nSubpaths are supported (\nexample.com/blog\n)\nYou can use either\nallowed_domains\nor\nblocked_domains\n, but not both in the same request.\n​\nLocalization\nThe\nuser_location\nparameter allows you to localize search results based on a user’s location.\ntype\n: The type of location (must be\napproximate\n)\ncity\n: The city name\nregion\n: The region or state\ncountry\n: The country\ntimezone\n: The\nIANA timezone ID\n.\n​\nResponse\nHere’s an example response structure:\n{\n\"role\"\n:\n\"assistant\"\n,\n\"content\"\n:\n[\n// 1. Claude's decision to search\n{\n\"type\"\n:\n\"text\"\n,\n\"text\"\n:\n\"I'll search for when Claude Shannon was born.\"\n}\n,\n// 2. The search query used\n{\n\"type\"\n:\n\"server_tool_use\"\n,\n\"id\"\n:\n\"srvtoolu_01WYG3ziw53XMcoyKL4XcZmE\"\n,\n\"name\"\n:\n\"web_search\"\n,\n\"input\"\n:\n{\n\"query\"\n:\n\"claude shannon birth date\"\n}\n}\n,\n// 3. Search results\n{\n\"type\"\n:\n\"web_search_tool_result\"\n,\n\"tool_use_id\"\n:\n\"srvtoolu_01WYG3ziw53XMcoyKL4XcZmE\"\n,\n\"content\"\n:\n[\n{\n\"type\"\n:\n\"web_search_result\"\n,\n\"url\"\n:\n\"https://en.wikipedia.org/wiki/Claude_Shannon\"\n,\n\"title\"\n:\n\"Claude Shannon - Wikipedia\"\n,\n\"encrypted_content\"\n:\n\"EqgfCioIARgBIiQ3YTAwMjY1Mi1mZjM5LTQ1NGUtODgxNC1kNjNjNTk1ZWI3Y...\"\n,\n\"page_age\"\n:\n\"April 30, 2025\"\n}\n]\n}\n,\n{\n\"text\"\n:\n\"Based on the search results, \"\n,\n\"type\"\n:\n\"text\"\n}\n,\n// 4. Claude's response with citations\n{\n\"text\"\n:\n\"Claude Shannon was born on April 30, 1916, in Petoskey, Michigan\"\n,\n\"type\"\n:\n\"text\"\n,\n\"citations\"\n:\n[\n{\n\"type\"\n:\n\"web_search_result_location\"\n,\n\"url\"\n:\n\"https://en.wikipedia.org/wiki/Claude_Shannon\"\n,\n\"title\"\n:\n\"Claude Shannon - Wikipedia\"\n,\n\"encrypted_index\"\n:\n\"Eo8BCioIAhgBIiQyYjQ0OWJmZi1lNm..\"\n,\n\"cited_text\"\n:\n\"Claude Elwood Shannon (April 30, 1916 – February 24, 2001) was an American mathematician, electrical engineer, computer scientist, cryptographer and i...\"\n}\n]\n}\n]\n,\n\"id\"\n:\n\"msg_a930390d3a\"\n,\n\"usage\"\n:\n{\n\"input_tokens\"\n:\n6039\n,\n\"output_tokens\"\n:\n931\n,\n\"server_tool_use\"\n:\n{\n\"web_search_requests\"\n:\n1\n}\n}\n,\n\"stop_reason\"\n:\n\"end_turn\"\n}\n​\nSearch results\nSearch results include:\nurl\n: The URL of the source page\ntitle\n: The title of the source page\npage_age\n: When the site was last updated\nencrypted_content\n: Encrypted content that must be passed back in multi-turn conversations for citations\n​\nCitations\nCitations are always enabled for web search, and each\nweb_search_result_location\nincludes:\nurl\n: The URL of the cited source\ntitle\n: The title of the cited source\nencrypted_index\n: A reference that must be passed back for multi-turn conversations.\ncited_text\n: Up to 150 characters of the cited content\nThe web search citation fields\ncited_text\n,\ntitle\n, and\nurl\ndo not count towards input or output token usage.\nWhen displaying web results or information contained in web results to end users, inline citations must be made clearly visible and clickable in your user interface.\n​\nErrors\nIf an error occurs during web search, you’ll receive a response that takes the following form:\n{\n\"type\"\n:\n\"web_search_tool_result\"\n,\n\"tool_use_id\"\n:\n\"servertoolu_a93jad\"\n,\n\"content\"\n:\n{\n\"type\"\n:\n\"web_search_tool_result_error\"\n,\n\"error_code\"\n:\n\"max_uses_exceeded\"\n}\n}\nThese are the possible error codes:\ntoo_many_requests\n: Rate limit exceeded\ninvalid_input\n: Invalid search query parameter\nmax_uses_exceeded\n: Maximum web search tool uses exceeded\nquery_too_long\n: Query exceeds maximum length\nunavailable\n: An internal error occurred\n​\npause_turn\nstop reason\nThe response may include a\npause_turn\nstop reason, which indicates that the API paused a long-running turn. You may provide the response back as-is in a subsequent request to let Claude continue its turn, or modify the content if you wish to interrupt the conversation.\n​\nPrompt caching\nWeb search works with\nprompt caching\n. To enable prompt caching, add at least one\ncache_control\nbreakpoint in your request. The system will automatically cache up until the last\nweb_search_tool_result\nblock when executing the tool.\nFor multi-turn conversations, set a\ncache_control\nbreakpoint on or after the last\nweb_search_tool_result\nblock to reuse cached content.\nFor example, to use prompt caching with web search for a multi-turn conversation:\nimport\nanthropic\nclient\n=\nanthropic\n.\nAnthropic\n(\n)\n# First request with web search and cache breakpoint\nmessages\n=\n[\n{\n\"role\"\n:\n\"user\"\n,\n\"content\"\n:\n\"What's the current weather in San Francisco today?\"\n}\n]\nresponse1\n=\nclient\n.\nmessages\n.\ncreate\n(\nmodel\n=\n\"claude-opus-4-20250514\"\n,\nmax_tokens\n=\n1024\n,\nmessages\n=\nmessages\n,\ntools\n=\n[\n{\n\"type\"\n:\n\"web_search_20250305\"\n,\n\"name\"\n:\n\"web_search\"\n,\n\"user_location\"\n:\n{\n\"type\"\n:\n\"approximate\"\n,\n\"city\"\n:\n\"San Francisco\"\n,\n\"region\"\n:\n\"California\"\n,\n\"country\"\n:\n\"US\"\n,\n\"timezone\"\n:\n\"America/Los_Angeles\"\n}\n}\n]\n)\n# Add Claude's response to the conversation\nmessages\n.\nappend\n(\n{\n\"role\"\n:\n\"assistant\"\n,\n\"content\"\n:\nresponse1\n.\ncontent\n}\n)\n# Second request with cache breakpoint after the search results\nmessages\n.\nappend\n(\n{\n\"role\"\n:\n\"user\"\n,\n\"content\"\n:\n\"Should I expect rain later this week?\"\n,\n\"cache_control\"\n:\n{\n\"type\"\n:\n\"ephemeral\"\n}\n# Cache up to this point\n}\n)\nresponse2\n=\nclient\n.\nmessages\n.\ncreate\n(\nmodel\n=\n\"claude-opus-4-20250514\"\n,\nmax_tokens\n=\n1024\n,\nmessages\n=\nmessages\n,\ntools\n=\n[\n{\n\"type\"\n:\n\"web_search_20250305\"\n,\n\"name\"\n:\n\"web_search\"\n,\n\"user_location\"\n:\n{\n\"type\"\n:\n\"approximate\"\n,\n\"city\"\n:\n\"San Francisco\"\n,\n\"region\"\n:\n\"California\"\n,\n\"country\"\n:\n\"US\"\n,\n\"timezone\"\n:\n\"America/Los_Angeles\"\n}\n}\n]\n)\n# The second response will benefit from cached search results\n# while still being able to perform new searches if needed\nprint\n(\nf\"Cache read tokens:\n{\nresponse2\n.\nusage\n.\nget\n(\n'cache_read_input_tokens'\n,\n0\n)\n}\n\"\n)\n​\nStreaming\nWith streaming enabled, you’ll receive search events as part of the stream. There will be a pause while the search executes:\nevent\n:\nmessage_start\ndata\n:\n{\n\"type\"\n:\n\"message_start\"\n,\n\"message\"\n:\n{\n\"id\"\n:\n\"msg_abc123\"\n,\n\"type\"\n:\n\"message\"\n}\n}\nevent\n:\ncontent_block_start\ndata\n:\n{\n\"type\"\n:\n\"content_block_start\"\n,\n\"index\"\n:\n0\n,\n\"content_block\"\n:\n{\n\"type\"\n:\n\"text\"\n,\n\"text\"\n:\n\"\"\n}\n}\n// Claude's decision to search\nevent\n:\ncontent_block_start\ndata\n:\n{\n\"type\"\n:\n\"content_block_start\"\n,\n\"index\"\n:\n1\n,\n\"content_block\"\n:\n{\n\"type\"\n:\n\"server_tool_use\"\n,\n\"id\"\n:\n\"srvtoolu_xyz789\"\n,\n\"name\"\n:\n\"web_search\"\n}\n}\n// Search query streamed\nevent\n:\ncontent_block_delta\ndata\n:\n{\n\"type\"\n:\n\"content_block_delta\"\n,\n\"index\"\n:\n1\n,\n\"delta\"\n:\n{\n\"type\"\n:\n\"input_json_delta\"\n,\n\"partial_json\"\n:\n\"{\\\"query\\\":\\\"latest quantum computing breakthroughs 2025\\\"}\"\n}\n}\n// Pause while search executes\n// Search results streamed\nevent\n:\ncontent_block_start\ndata\n:\n{\n\"type\"\n:\n\"content_block_start\"\n,\n\"index\"\n:\n2\n,\n\"content_block\"\n:\n{\n\"type\"\n:\n\"web_search_tool_result\"\n,\n\"tool_use_id\"\n:\n\"srvtoolu_xyz789\"\n,\n\"content\"\n:\n[\n{\n\"type\"\n:\n\"web_search_result\"\n,\n\"title\"\n:\n\"Quantum Computing Breakthroughs in 2025\"\n,\n\"url\"\n:\n\"https://example.com\"\n}\n]\n}\n}\n// Claude's response with citations (omitted in this example)\n​\nBatch requests\nYou can include the web search tool in the\nMessages Batches API\n. Web search tool calls through the Messages Batches API are priced the same as those in regular Messages API requests.\n​\nUsage and pricing\nWeb search usage is charged in addition to token usage:\n\"usage\"\n:\n{\n\"input_tokens\"\n:\n105\n,\n\"output_tokens\"\n:\n6039\n,\n\"cache_read_input_tokens\"\n:\n7123\n,\n\"cache_creation_input_tokens\"\n:\n7345\n,\n\"server_tool_use\"\n:\n{\n\"web_search_requests\"\n:\n1\n}\n}\nWeb search is available on the Anthropic API for\n$10 per 1,000 searches\n, plus standard token costs for search-generated content. Web search results retrieved throughout a conversation are counted as input tokens, in search iterations executed during a single turn and in subsequent conversation turns.\nEach web search counts as one use, regardless of the number of results returned. If an error occurs during web search, the web search will not be billed.\nWas this page helpful?\nYes\nNo\nText editor tool\nMCP connector\nOn this page\nSupported models\nHow web search works\nHow to use web search\nTool definition\nMax uses\nDomain filtering\nLocalization\nResponse\nSearch results\nCitations\nErrors\npause_turn stop reason\nPrompt caching\nStreaming\nBatch requests\nUsage and pricing",
  "links": [
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/ticket-routing",
      "text": "Ticket routing"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/customer-support-chat",
      "text": "Customer support agent"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/content-moderation",
      "text": "Content moderation"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/legal-summarization",
      "text": "Legal summarization"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices",
      "text": "Claude 4 best practices"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-generator",
      "text": "Prompt generator"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-templates-and-variables",
      "text": "Use prompt templates"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-improver",
      "text": "Prompt improver"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/be-clear-and-direct",
      "text": "Be clear and direct"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/multishot-prompting",
      "text": "Use examples (multishot prompting)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-of-thought",
      "text": "Let Claude think (CoT)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/use-xml-tags",
      "text": "Use XML tags"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/system-prompts",
      "text": "Give Claude a role (system prompts)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prefill-claudes-response",
      "text": "Prefill Claude's response"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-prompts",
      "text": "Chain complex prompts"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/long-context-tips",
      "text": "Long context tips"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/extended-thinking-tips",
      "text": "Extended thinking tips"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/define-success",
      "text": "Define success criteria"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/develop-tests",
      "text": "Develop test cases"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/eval-tool",
      "text": "Using the Evaluation Tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-latency",
      "text": "Reducing latency"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations",
      "text": "Reduce hallucinations"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/increase-consistency",
      "text": "Increase output consistency"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks",
      "text": "Mitigate jailbreaks"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals",
      "text": "Streaming refusals"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-prompt-leak",
      "text": "Reduce prompt leak"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/keep-claude-in-character",
      "text": "Keep Claude in character"
    }
  ],
  "metadata": {
    "scraped_at": "2025-06-23T15:07:44.502541",
    "word_count": 1927,
    "link_count": 29,
    "content_length": 12287
  }
}