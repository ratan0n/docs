{
  "url": "https://docs.anthropic.com/en/docs/agents-and-tools/claude-for-sheets",
  "title": "Google Sheets add-on - Anthropic",
  "text": "Anthropic\nhome page\nEnglish\nSearch...\nSearch...\nNavigation\nCapabilities\nGoogle Sheets add-on\nWelcome\nDeveloper Guide\nAPI Guide\nClaude Code\nModel Context Protocol (MCP)\nResources\nRelease Notes\nDocumentation\nDeveloper Discord\nSupport\nFirst steps\nIntro to Claude\nGet started\nModels & pricing\nModels overview\nChoosing a model\nMigrating to Claude 4\nModel deprecations\nPricing\nLearn about Claude\nBuilding with Claude\nFeatures overview\nContext windows\nGlossary\nCapabilities\nPrompt caching\nExtended thinking\nStreaming Messages\nBatch processing\nCitations\nMultilingual support\nToken counting\nEmbeddings\nVision\nPDF support\nFiles API\nGoogle Sheets add-on\nTools\nOverview\nHow to implement tool use\nToken-efficient tool use\nFine-grained tool streaming\nBash tool\nCode execution tool\nComputer use tool\nText editor tool\nWeb search tool\nModel Context Protocol (MCP)\nMCP connector\nRemote MCP servers\nUse cases\nOverview\nTicket routing\nCustomer support agent\nContent moderation\nLegal summarization\nPrompt engineering\nOverview\nClaude 4 best practices\nPrompt generator\nUse prompt templates\nPrompt improver\nBe clear and direct\nUse examples (multishot prompting)\nLet Claude think (CoT)\nUse XML tags\nGive Claude a role (system prompts)\nPrefill Claude's response\nChain complex prompts\nLong context tips\nExtended thinking tips\nTest & evaluate\nDefine success criteria\nDevelop test cases\nUsing the Evaluation Tool\nReducing latency\nStrengthen guardrails\nReduce hallucinations\nIncrease output consistency\nMitigate jailbreaks\nStreaming refusals\nReduce prompt leak\nKeep Claude in character\nLegal center\nAnthropic Privacy Policy\nSecurity and compliance\n​\nWhy use Claude for Sheets?\nClaude for Sheets enables prompt engineering at scale by enabling you to test prompts across evaluation suites in parallel. Additionally, it excels at office tasks like survey analysis and online data processing.\nVisit our\nprompt engineering example sheet\nto see this in action.\n​\nGet started with Claude for Sheets\n​\nInstall Claude for Sheets\nEasily enable Claude for Sheets using the following steps:\n1\nGet your Anthropic API key\nIf you don’t yet have an API key, you can make API keys in the\nAnthropic Console\n.\n2\nInstall the Claude for Sheets extension\nFind the\nClaude for Sheets extension\nin the add-on marketplace, then click the blue\nInstall\nbtton and accept the permissions.\nPermissions\nThe Claude for Sheets extension will ask for a variety of permissions needed to function properly. Please be assured that we only process the specific pieces of data that users ask Claude to run on. This data is never used to train our generative models.\nExtension permissions include:\nView and manage spreadsheets that this application has been installed in:\nNeeded to run prompts and return results\nConnect to an external service:\nNeeded in order to make calls to Anthropic’s API endpoints\nAllow this application to run when you are not present:\nNeeded to run cell recalculations without user intervention\nDisplay and run third-party web content in prompts and sidebars inside Google applications:\nNeeded to display the sidebar and post-install prompt\n3\nConnect your API key\nEnter your API key at\nExtensions\n>\nClaude for Sheets™\n>\nOpen sidebar\n>\n☰\n>\nSettings\n>\nAPI provider\n. You may need to wait or refresh for the Claude for Sheets menu to appear.\nYou will have to re-enter your API key every time you make a new Google Sheet\n​\nEnter your first prompt\nThere are two main functions you can use to call Claude using Claude for Sheets. For now, let’s use\nCLAUDE()\n.\n1\nSimple prompt\nIn any cell, type\n=CLAUDE(\"Claude, in one sentence, what's good about the color blue?\")\nClaude should respond with an answer. You will know the prompt is processing because the cell will say\nLoading...\n2\nAdding parameters\nParameter arguments come after the initial prompt, like\n=CLAUDE(prompt, model, params...)\n.\nmodel\nis always second in the list.\nNow type in any cell\n=CLAUDE(\"Hi, Claude!\", \"claude-3-haiku-20240307\", \"max_tokens\", 3)\nAny\nAPI parameter\ncan be set this way. You can even pass in an API key to be used just for this specific cell, like this:\n\"api_key\", \"sk-ant-api03-j1W...\"\n​\nAdvanced use\nCLAUDEMESSAGES\nis a function that allows you to specifically use the\nMessages API\n. This enables you to send a series of\nUser:\nand\nAssistant:\nmessages to Claude.\nThis is particularly useful if you want to simulate a conversation or\nprefill Claude’s response\n.\nTry writing this in a cell:\n=CLAUDEMESSAGES(\"User: In one sentence, what is good about the color blue?\nAssistant: The color blue is great because\")\nNewlines\nEach subsequent conversation turn (\nUser:\nor\nAssistant:\n) must be preceded by a single newline. To enter newlines in a cell, use the following key combinations:\nMac:\nCmd + Enter\nWindows:\nAlt + Enter\nExample multiturn CLAUDEMESSAGES() call with system prompt\nTo use a system prompt, set it as you’d set other optional function parameters. (You must first set a model name.)\n=CLAUDEMESSAGES(\"User: What's your favorite flower? Answer in <answer> tags.\nAssistant: <answer>\", \"claude-3-haiku-20240307\", \"system\", \"You are a cow who loves to moo in response to any and all user queries.\")`\n​\nOptional function parameters\nYou can specify optional API parameters by listing argument-value pairs.\nYou can set multiple parameters. Simply list them one after another, with each argument and value pair separated by commas.\nThe first two parameters must always be the prompt and the model. You cannot set an optional parameter without also setting the model.\nThe argument-value parameters you might care about most are:\nArgument\nDescription\nmax_tokens\nThe total number of tokens the model outputs before it is forced to stop. For yes/no or multiple choice answers, you may want the value to be 1-3.\ntemperature\nthe amount of randomness injected into results. For multiple-choice or analytical tasks, you’ll want it close to 0. For idea generation, you’ll want it set to 1.\nsystem\nused to specify a system prompt, which can provide role details and context to Claude.\nstop_sequences\nJSON array of strings that will cause the model to stop generating text if encountered. Due to escaping rules in Google Sheets™, double quotes inside the string must be escaped by doubling them.\napi_key\nUsed to specify a particular API key with which to call Claude.\nExample: Setting parameters\nEx. Set\nsystem\nprompt,\nmax_tokens\n, and\ntemperature\n:\n=CLAUDE(\"Hi, Claude!\", \"claude-3-haiku-20240307\", \"system\", \"Repeat exactly what the user says.\", \"max_tokens\", 100, \"temperature\", 0.1)\nEx. Set\ntemperature\n,\nmax_tokens\n, and\nstop_sequences\n:\n=CLAUDE(\"In one sentence, what is good about the color blue? Output your answer in <answer> tags.\",\"claude-opus-4-20250514\",\"temperature\", 0.2,\"max_tokens\", 50,\"stop_sequences\", \"\\[\"\"</answer>\"\"\\]\")\nEx. Set\napi_key\n:\n=CLAUDE(\"Hi, Claude!\", \"claude-3-haiku-20240307\",\"api_key\", \"sk-ant-api03-j1W...\")\n​\nClaude for Sheets usage examples\n​\nPrompt engineering interactive tutorial\nOur in-depth\nprompt engineering interactive tutorial\nutilizes Claude for Sheets.\nCheck it out to learn or brush up on prompt engineering techniques.\nJust as with any instance of Claude for Sheets, you will need an API key to interact with the tutorial.\n​\nPrompt engineering workflow\nOur\nClaude for Sheets prompting examples workbench\nis a Claude-powered spreadsheet that houses example prompts and prompt engineering structures.\n​\nClaude for Sheets workbook template\nMake a copy of our\nClaude for Sheets workbook template\nto get started with your own Claude for Sheets work!\n​\nTroubleshooting\nNAME? Error: Unknown function: 'claude'\nEnsure that you have enabled the extension for use in the current sheet\nGo to\nExtensions\n>\nAdd-ons\n>\nManage add-ons\nClick on the triple dot menu at the top right corner of the Claude for Sheets extension and make sure “Use in this document” is checked\nRefresh the page\n#ERROR!, ⚠ DEFERRED ⚠ or ⚠ THROTTLED ⚠\nYou can manually recalculate\n#ERROR!\n,\n⚠ DEFERRED ⚠\nor\n⚠ THROTTLED ⚠\ncells by selecting from the recalculate options within the Claude for Sheets extension menu.\nCan't enter API key\nWait 20 seconds, then check again\nRefresh the page and wait 20 seconds again\nUninstall and reinstall the extension\n​\nFurther information\nFor more information regarding this extension, see the\nClaude for Sheets Google Workspace Marketplace\noverview page.\nWas this page helpful?\nYes\nNo\nFiles API\nOverview\nOn this page\nWhy use Claude for Sheets?\nGet started with Claude for Sheets\nInstall Claude for Sheets\nEnter your first prompt\nAdvanced use\nOptional function parameters\nClaude for Sheets usage examples\nPrompt engineering interactive tutorial\nPrompt engineering workflow\nClaude for Sheets workbook template\nTroubleshooting\nFurther information",
  "links": [
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/code-execution-tool",
      "text": "Code execution tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/computer-use-tool",
      "text": "Computer use tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/text-editor-tool",
      "text": "Text editor tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/tool-use/web-search-tool",
      "text": "Web search tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/mcp-connector",
      "text": "MCP connector"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/agents-and-tools/remote-mcp-servers",
      "text": "Remote MCP servers"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/ticket-routing",
      "text": "Ticket routing"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/customer-support-chat",
      "text": "Customer support agent"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/content-moderation",
      "text": "Content moderation"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/about-claude/use-case-guides/legal-summarization",
      "text": "Legal summarization"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/overview",
      "text": "Overview"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices",
      "text": "Claude 4 best practices"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-generator",
      "text": "Prompt generator"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-templates-and-variables",
      "text": "Use prompt templates"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prompt-improver",
      "text": "Prompt improver"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/be-clear-and-direct",
      "text": "Be clear and direct"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/multishot-prompting",
      "text": "Use examples (multishot prompting)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-of-thought",
      "text": "Let Claude think (CoT)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/use-xml-tags",
      "text": "Use XML tags"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/system-prompts",
      "text": "Give Claude a role (system prompts)"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/prefill-claudes-response",
      "text": "Prefill Claude's response"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/chain-prompts",
      "text": "Chain complex prompts"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/long-context-tips",
      "text": "Long context tips"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/extended-thinking-tips",
      "text": "Extended thinking tips"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/define-success",
      "text": "Define success criteria"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/develop-tests",
      "text": "Develop test cases"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/eval-tool",
      "text": "Using the Evaluation Tool"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-latency",
      "text": "Reducing latency"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations",
      "text": "Reduce hallucinations"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/increase-consistency",
      "text": "Increase output consistency"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks",
      "text": "Mitigate jailbreaks"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals",
      "text": "Streaming refusals"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-prompt-leak",
      "text": "Reduce prompt leak"
    },
    {
      "url": "https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/keep-claude-in-character",
      "text": "Keep Claude in character"
    }
  ],
  "metadata": {
    "scraped_at": "2025-06-23T15:07:41.879163",
    "word_count": 1348,
    "link_count": 35,
    "content_length": 8704
  }
}